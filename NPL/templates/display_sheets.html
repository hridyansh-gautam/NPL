<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <script src="{{ url_for('static', filename='display_sheets.js') }}" defer></script>
    <title>Excel Sheets Display</title>
</head>
<body>
    <header>
        <img src="{{ url_for('static', filename='images/logo1.png') }}" alt="National Physical Laboratory Logo" class="logo" />
        <div>
            <h1 class="page-title">CSIR - National Physical Laboratory</h1>
            <h3 class="page-subtitle">Calibration Services</h3>
        </div>
        <img class="company-name" src="{{ url_for('static', filename='images/logo2.png') }}" alt="CSIR - NPL" />
    </header>
    <form class="form">
        <div class="progressbar">
            <div class="progress" id="progress"></div>
            {% set sheet_names = [
                "D1.08b", "D1.08c", "D2.01a", "D2.01c", "D2.03", 
                "D2.05", "D3.02", "D3.03", "D6.01", "D6.02a", 
                "D6.02b", "D6.02c", "D6.02d", "D6.03a", "D6.03b"
            ] %}
            {% for i in range(sheet_names|length) %}
                <div class="progress-step{% if i == 0 %} progress-step-active{% endif %}" data-title="{{ sheet_names[i] }}"></div>
            {% endfor %}
        </div>

        {% for i, df_html in enumerate(dataframes) %}
        <div class="form-step{% if i == 0 %} form-step-active{% endif %}">
            <h2>
                {% if filenames[i] == "D1.08b.xlsx" %}
                Calibration Charges: D1.08b, Fluid Flow Metrology
                {% elif filenames[i] == "D1.08c.xlsx" %}
                Calibration Charges: D1.08c, Fluid Flow Metrology
                {% elif filenames[i] == "D2.01a.xlsx" %}
                Calibration Charges : D2.01a
                {% elif filenames[i] == "D2.01c.xlsx" %}
                Calibration Charges: D2.01c, LF, HF Impedance & DC Metrology
                {% elif filenames[i] == "D2.03.xlsx" %}
                Calibration Charges: D2.03, AC Power & Energy Metrology
                {% elif filenames[i] == "D2.05.xlsx" %}
                Calibration Charges: D2.05 Quantum Hall Resistance Standards
                {% elif filenames[i] == "D3.02.xlsx" %}
                Calibration Charges: D3.02, Gas Metrology
                {% elif filenames[i] == "D3.03.xlsx" %}
                Calibration Charges: D3.03 Defibrillator Analyser & Defibrillator Machine Standard
                {% elif filenames[i] == "D6.01.xlsx" %}
                Calibration Charges: D6.01, Time & Frequency Standard
                {% elif filenames[i] == "D6.02a.xlsx" %}
                Calibration Charges: D6.02a, LF & HF Voltage, Current and Microwave Metrology
                {% elif filenames[i] == "D6.02b.xlsx" %}
                Calibration Charges: D6.02b, LF & HF Voltage, Current and Microwave Metrology
                {% elif filenames[i] == "D6.02c.xlsx" %}
                Calibration Charges: D6.02c, LF & HF Voltage, Current and Microwave Metrology
                {% elif filenames[i] == "D6.02d.xlsx" %}
                Calibration Charges: D6.02d, LF & HF Voltage, Current and Microwave Metrology
                {% elif filenames[i] == "D6.03a.xlsx" %}
                Calibration Charges: D6.03a, Electromagnetic   Metrology Section
                {% elif filenames[i] == "D6.03b.xlsx" %}
                Calibration Charges: D6.03b, Electromagnetic   Metrology Section
                {% else %}
                    Excel Sheet {{ i+1 }}
                {% endif %}
            </h2>
            <div class="table-responsive">
                {{ df_html | safe }}
            </div>
        </div>
        {% endfor %}
    </form>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"
      integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
</body>
</html>